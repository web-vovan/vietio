vietio.ru, www.vietio.ru {

    encode gzip

    handle /api/* {
        reverse_proxy backend:8888
    }

    handle {
        root * /srv
        
        @noCache {
            path /index.html *.json
        }
        header @noCache {
            Cache-Control "no-cache, no-store, must-revalidate"
            Pragma "no-cache"
            Expires "0"
        }

        @staticCache {
            path *.js *.css *.png *.jpg *.jpeg *.svg *.ico *.woff *.woff2
        }
        header @staticCache {
            Cache-Control "public, max-age=31536000, immutable"
        }

        try_files {path} /index.html
        file_server
    }
}